import{a as k,r as b,b as P,u as S,j as a,B as D,t as n,e as r,d as $}from"./index-DauSMKcA.js";import{i as F,j as H,k as B,l as E,m as L}from"./DashboardActions-Df3wgi1u.js";import{B as W}from"./ButtonWhiteComponent-LQdu443F.js";import{D as T}from"./DashboardLoading-B6-U7bHF.js";/* empty css              */const C=({type:f})=>{const w=k(t=>t.auth),[_,s]=b.useState(!1),[e,I]=b.useState({acc_name:"",acc_password:"",acc_id:"",server_name:""}),N=P(),v=S(),A=async()=>{if(!e.acc_name||!e.acc_password||!e.acc_id||!e.server_name){n.warning("Please Input Account All Informations");return}s(!0);let t=!1;f==="Metatrader4"?await F(e.server_name).then(async p=>{if(p.status!==200){n.error("The specified company name could not be found. Please confirm that the company name is correct!"),s(!1);return}const i=p.data[0].results,o=await(i==null?void 0:i.find(d=>d.name===e.server_name));if(!o){n.error("Metatrader address not found! Please input address correctly!"),s(!1);return}const c=o==null?void 0:o.access;for(let d=0;d<(c==null?void 0:c.length);d++){const u=c[d].split(":");let m=u[0],h="";u.length>1&&(h=u[1]),await H({user:e.acc_id,password:e.acc_password,host:m,port:h}).then(async x=>{if(!t&&x.status===200){t=!0,await N(B({encrypted_token:r(x.data),encrypted_acc_id:r(e.acc_id),encrypted_acc_password:r(e.acc_password),encrypted_acc_server_name:r(e.server_name),encrypted_host:r(m),encrypted_port:r(h),encrypted_acc_name:r(e.acc_name),encrypted_type:r("mt4"),encrypted_user_id:r(w.user.id)})).then(j=>{j.status===200?n.success("Metatrader4 account has been deployed successfully!"):j.status===201&&n.warning(j.data),s(!1),v("/dashboard/deployaccount")}).catch(()=>{s(!1)});return}})}}).catch(()=>{s(!1)}):await E(e.server_name).then(async p=>{const g=p[0].results,i=await(g==null?void 0:g.find(c=>c.name===e.server_name));if(!i){n.error("Metatrader address not found! Please input address correctly!"),s(!1);return}const o=i==null?void 0:i.access;for(let c=0;c<(o==null?void 0:o.length);c++){const d=o[c].split(":");let u=d[0],m="";d.length>1&&(m=d[1]),await L({user:e.acc_id,password:e.acc_password,host:u,port:m}).then(async h=>{if(!t&&h.status===200){t=!0,await N(B({encrypted_token:r(h.data),encrypted_acc_id:r(e.acc_id),encrypted_acc_password:r(e.acc_password),encrypted_acc_server_name:r(e.server_name),encrypted_host:r(u),encrypted_port:r(m),encrypted_acc_name:r(e.acc_name),encrypted_type:r("mt5"),encrypted_user_id:r(w.user.id)})).then(x=>{x.status===200?n.success("Metatrader5 account has been added successfully!"):x.status===201&&n.warning(x.data),s(!1),v("/dashboard/deployaccount")}).catch(()=>{s(!1)});return}})}}),t||n.error("Invalid Account!"),s(!1)},M=()=>{v("/dashboard/deployaccount/addaccounts")},y=(t,p)=>{if(/[\'\";\\]/.test(p)){n.warning("Account Name contains forbidden characters.");return}I({...e,[t]:p})},l=k(t=>t.toggle.theme);return a.jsx(a.Fragment,{children:_?a.jsx(T,{text:"Deploying"}):a.jsxs("div",{className:`${l==="dark"?"border-color8":"border-lightBorder"} w-full border rounded-xl`,children:[a.jsx("div",{className:`${l==="dark"?"bg-color1 text-color4":"bg-lightCardBack text-lightFontColor"} px-8 w-full h-[88px] font-medium text-xl flex items-center justify-start rounded-t-xl`,children:f+" Integration as Master"}),a.jsxs("div",{className:`${l==="dark"?"border-color2 text-color4":"border-lightBorder text-lightFontColor"} py-8 px-16 grid md:grid-cols-2 gap-x-6 gap-y-12 bg-transparent border-t-[1px] border-b-[1px]`,children:[a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-[18px]",children:"Account Name"}),a.jsx("input",{className:`${l==="dark"?"bg-color3 border-color8":"bg-lightInputBack border-lightBorder"} px-8 w-full h-[56px] focus:border-[1px] outline-none rounded-lg border`,placeholder:"Input Account Name",value:e.acc_name,onChange:t=>y("acc_name",t.target.value)})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-[18px]",children:"Account Id"}),a.jsx("input",{className:`${l==="dark"?"bg-color3 border-color8":"bg-lightInputBack border-lightBorder"} px-8 w-full h-[56px] focus:border-[1px] outline-none rounded-lg border`,placeholder:"Input Account Id",value:e.acc_id,onChange:t=>y("acc_id",t.target.value)})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-[18px]",children:"Account Password"}),a.jsx("input",{type:"password",className:`${l==="dark"?"bg-color3 border-color8":"bg-lightInputBack border-lightBorder"} px-8 w-full h-[56px] focus:border-[1px] outline-none rounded-lg border`,placeholder:"Input Account Password",value:e.acc_password,onChange:t=>y("acc_password",t.target.value)})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-[18px]",children:"Server Name"}),a.jsx("input",{className:`${l==="dark"?"bg-color3 border-color8":"bg-lightInputBack border-lightBorder"} px-8 w-full h-[56px] focus:border-[1px] outline-none rounded-lg border`,placeholder:"Input Server Name",value:e.server_name,onChange:t=>y("server_name",t.target.value)})]})]}),a.jsxs("div",{className:`${l==="dark"?"bg-color1":"bg-lightCardBack"} px-8 w-full h-[88px] flex items-center justify-end gap-4 rounded-b-xl `,children:[a.jsx(W,{text:"Back",className:"h-12 w-[150px]",handleClick:M}),a.jsx(D,{text:"Deploy",className:"h-12 w-[150px]",handleClick:A})]})]})})},J=()=>{const[f,w]=$(),[_,s]=b.useState("");return b.useEffect(()=>{const e=f.get("type");e&&s(e)},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex flex-col items-center gap-12",children:[_==="mt4"&&a.jsx(C,{type:"Metatrader4"}),_==="mt5"&&a.jsx(C,{type:"Metatrader5"})]})})};export{J as default};
